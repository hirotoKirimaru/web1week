<template>
  <v-container>
    <v-row
      class="text-center"
      :style="{
        height:300 + 'px',
      }"
    >
      <v-col xs="12">
        <PerformanceArea
          :performerList="performerList"
        />
      </v-col>
    </v-row>
    <v-row>
      <v-btn
        dark
        fab
        bottom
        right
        color="purple darken-2"
        @click.stop="dialog = true"
      >
        <v-icon>mdi-plus</v-icon>
      </v-btn>
      <v-dialog
        v-model="dialog"
        max-width="500"
      >
        <v-card>
          <v-card-title class="headline">踊り子を追加しますか？</v-card-title>

          <v-text-field
            v-model="tmpPerformer.id"
            label="駒のID"
            required
          ></v-text-field>

          <v-text-field
            v-model="tmpPerformer.position.x"
            label="駒の位置(x)"
            required
          ></v-text-field>

          <v-text-field
            v-model="tmpPerformer.position.y"
            label="駒の位置(y)"
            required
          ></v-text-field>


          <v-text-field
            v-model="tmpPerformer.shortName"
            :count="2"
            label="踊り子の短縮名称(駒の表示に使用)"
            required
          ></v-text-field>

          <v-text-field
            v-model="tmpPerformer.longName"
            label="踊り子名"
            required
          ></v-text-field>

          <v-card-actions>
            <v-spacer></v-spacer>

            <v-btn
              @click="dialog = false"
            >
              破棄
            </v-btn>

            <v-btn
              @click="addPerformer"
            >
              追加
            </v-btn>
          </v-card-actions>
        </v-card>
      </v-dialog>

    </v-row>
    <v-row class="text-center">
      <v-col xs="12">
        <PerformerList
          :performerList="performerList"
          @deletePerformer="deletePerformer"
        />
      </v-col>
    </v-row>
  </v-container>
</template>


<script lang="ts">
import { Component, Vue } from 'vue-property-decorator';
import Performer from '@/types/performer';

  @Component({
    components: {
      PerformanceArea: () => import('@/components/PerformanceArea.vue'),
      PerformerList: () => import('@/components/PerformerList.vue'),
    },
  })
export default class HelloWorld extends Vue {
    private dialog = false;

    private tmpPerformer: Performer = {
      id: 0,
      position: {
        x: 0,
        y: 0,
      },
      shortName: '',
      longName: '',
    };

    private performerList: Performer[] = [
      {
        id: 1,
        position: {
          x: 100,
          y: 100,
        },
        shortName: '桐',
        longName: 'きり丸',
      },
      {
        id: 2,
        position: {
          x: 200,
          y: 100,
        },
        shortName: '無',
        longName: 'ナイナイ',
      },
      {
        id: 3,
        position: {
          x: 300,
          y: 100,
        },
        shortName: '水',
        longName: '水上',
      },
      {
        id: 4,
        position: {
          x: 200,
          y: 50,
        },
        shortName: 'ゴ',
        longName: 'ゴリラ',
      },
    ];

    addPerformer() {
      this.dialog = false;

      const tmp = { ...this.tmpPerformer };

      this.performerList.push(tmp);
    }

    deletePerformer(deletePerformer: Performer) {
      const deleteIndex = this.performerList.findIndex((performer) => performer.id === deletePerformer.id, 0);

      this.performerList.splice(deleteIndex, 1);
    }
}
</script>
